
2025 年 9 月，主播和团队成员第一次拿到「高教社杯」全国大学生竞赛的题目时，临床案例里那句 “高 BMI 孕妇因检测时机不当错过最佳干预窗口” 的描述，瞬间让我们意识到这不是一道单纯的数学题 —— 我们要做的，是能真正落地临床、减少医患遗憾的解决方案。接下来的三天，从数据清洗到模型迭代，从无数次失败到最终提交，每一步都刻满了团队的心血。

## 一、初遇数据集：在 “混乱” 中搭建分析框架

竞赛题目提供的 1082 条 NIPT 数据，初看时像一团乱麻：BMI 缺失值散落在不同字段，孕周记录格式五花八门（“13w+4d”“91 天”“13 周” 并存），同一孕妇单次抽血的 3 次重复检测数据混在其中，更棘手的是 GC 含量异常的样本占比高达 47.97%。如果不先理清这些 “乱象”，后续建模只会 “差之毫厘，谬以千里”。
![[截屏2025-10-23 22.32.03.png]]
团队第一步就扎进了数据预处理。针对 BMI 缺失，我们从原始数据中提取身高、体重，用 BMI = 体重 (kg)/ 身高 (m)² 重新计算填补；末次月经缺失的 5 例样本因占比过低，为避免偏差直接剔除。为统一时间尺度，主播写了正则表达式脚本，将所有 “周 + 天” 格式转换成总天数，比如 “23w+4d” 换算成 165 天，确保建模时时间维度的一致性。

最耗时的是数据聚合与质量控制。同一孕妇同次抽血的多次检测属于重复测量，我们按 “孕妇代码 + 检测抽血次数” 分组，对 BMI、孕周等指标取均值，避免数据权重失衡；针对 GC 含量，参考临床共识设定总 GC 含量正常范围为 \[40%,60%\]，又通过计算 13 号、18 号、21 号染色体 GC 含量的 5% 和 95% 分位数，确定各染色体的特异性阈值，将所有超标样本标记为低质量，后续建模时降低其权重。

那段时间，团队每天对着 Python 可视化图表反复核对 —— 当看到 85% 的孕妇集中在 25-34 岁，检测孕周主要分布在 17.5-22.5 周时，我们才松了口气：这些数据既符合临床实际，又有足够的个体差异可供挖掘，为后续建模打下了坚实基础。

## 二、问题一攻坚：用混合效应模型打破 “虚假无关”

竞赛第一题要求分析 BMI、孕周与胎儿 Y 染色体浓度的相关性，起初主播信心满满地用皮尔逊相关系数计算，结果却令人沮丧 —— 整体相关性系数最高仅 - 0.164，多数指标与 Y 染色体浓度的关联微弱，甚至看不出明显趋势。难道这些生理指标真的无关紧要？

就在大家陷入迷茫时，主播突然想到：“同一孕妇有多次检测数据，这是嵌套结构，不能当独立样本处理。” 这句话点醒了我们。原来，孕妇个体差异（如基础代谢、胎盘功能）掩盖了群体层面的相关性。主播决定改用混合效应模型，将 “群体平均趋势”（固定效应）和 “个体差异”（随机效应）分开建模，看到可视化图表，这才释然。
![[截屏2025-10-23 22.33.07.png]]
为消除 BMI 和孕周的拮抗关系，我们构建新指标 cfEB=Y 染色体浓度 / BMI×1000，再对 BMI 和孕周做中心化处理，让截距项更具临床意义。建模过程中，我们尝试了 “仅随机截距”“随机截距 + 随机斜率” 等多种结构，最终通过似然比检验（LRT）发现，纳入孕周随机斜率的模型拟合效果显著更优 —— 条件 R² 从 0.141 飙升至 0.726，意味着模型能解释 72.6% 的变异，而之前的普通回归仅能解释 14.1%。
![[截屏2025-10-23 22.33.48.png]]
当 Wald 检验结果显示：孕周对 Y 染色体浓度是显著正向影响（z=13.218，p<0.001），BMI 是显著负向影响（z=-2.563，p=0.010）时，主播和其他的小伙伴们都兴奋地击掌 —— 这个结果不仅符合医学常识（孕周越大胎盘发育越成熟，胎儿游离 DNA 越多；高 BMI 会稀释胎儿 DNA），更证明了个体差异的重要性，为后续个性化检测方案提供了理论依据。

## 三、问题二突破：AFT 模型与决策树的 “双向奔赴”

第二题要求按 BMI 分组并确定最佳检测时点，这面临两个核心难题：如何科学分组？如何处理 “删失数据”（如部分孕妇末次检测仍未达标，部分首次检测就达标）？

主播和伙伴们先尝试 K-means 聚类，但 BMI 与 Y 染色体浓度的非线性关系让聚类结果混乱。后来想到，决策树能通过最小化信息熵自动找到最优分割点，还能结合临床意义调整。我们为每位孕妇构建线性回归，提取基线 Y 浓度（β₀）、孕周效应（β₁）、BMI 效应（β₂）作为特征，用 CART 回归树最终将 BMI 分成 4 组：\[20.7,30.3\]、\[30.4,31.8\]、\[31.8,33.8\]、\[33.9,46.9\]，每组的 β 系数特征一致性很高，让分组结果更具说服力。

处理删失数据时，生存分析中的 AFT（加速时间失效模型）成了 “救星”。它能同时应对左删失、右删失和区间删失，还能输出时间概率分布，比普通回归更贴合 “达标时间” 的实际场景。我们用 Weibull 分布拟合 AFT 模型，提取 P50（中位数）、P90（90% 分位数）作为推荐时点 —— 考虑到临床对准确性的高要求，最终选择 P90 分位数，确保 90% 的孕妇在该时点检测能达标。
![[截屏2025-10-23 22.36.43.png]]
为验证模型稳健性，主播和伙伴们做了蒙特卡洛模拟，给 Y 浓度、孕周、达标阈值分别添加 7%、0.2 周、0.001 的随机扰动，结果各组推荐时点的变异系数（CV）都低于 0.03，波动仅 0.6-2.1 天，完全在临床可接受范围内。当看到不同 BMI 组的生存曲线清晰分离，高 BMI 组的推荐时点（17.4 周）比低 BMI 组（15.7 周）晚近 2 周时，我们真切感受到：数据驱动的个性化方案，比经验判断更精准。

## 四、问题三升级：多因素与风险控制的 “双重保障”

第三题要求加入年龄、身高、体重等多变量，这就需要先解决多重共线性问题 —— 比如身高和体重的相关系数达 0.619，直接入模会放大误差。伙伴们用方差膨胀因子（VIF）检验，发现所有变量的 VIF 都小于 2，说明多重共线性不影响模型结果，于是放心地将身高、体重、年龄、产次等纳入协变量矩阵。

个体回归结果很有意思：年龄越大，Y 染色体浓度略低（γ_age 多为负）；经产妇比初产妇的胎儿游离 DNA 更多（γ_par 多为正），这与文献结论一致。但竞赛题目更强调风险控制 —— 医学决策不能只看 “平均情况”，还要防范极端风险。我们引入 CVaR（条件风险价值），量化 “未达标” 的尾部风险，确保推荐时点在最大可接受风险范围内。

最终结果显示，BMI 越高，CVaR 值越大：BMI 最高组（33.4-46.9）的 95% CVaR 达 23.148 周，而最低组（20.7-29.8）仅 19.737 周。这意味着高 BMI 孕妇不仅达标时间晚，风险波动也更大，临床中需要更保守的检测策略 —— 比如推迟到 19 周后检测，同时加强随访。

## 五、问题四博弈：与数据不平衡的 “殊死较量”

第四题是女胎异常判定，典型的二分类问题，但异常样本仅占 6.2%，数据极度不平衡。如果直接建模，模型会偏向预测 “正常”，导致漏诊率飙升 —— 这在临床中是绝对不能接受的，也不符合对 “临床实用性” 的要求。
![[截屏2025-10-23 22.38.18.png]]
主播和伙伴们对比了 SMOTE 和低秩优化两种过采样方法。SMOTE 通过线性插值生成新样本，但容易产生 “越界数据”；而低秩优化能从全局结构中生成更符合真实分布的样本，类间距离从 43.337 提升到 68.977，分离效果更优。最终我们用低秩优化将异常样本比例提升至近 50%，再用代价敏感 XGBoost 建模 —— 通过设置更高的漏诊代价（CFN），强制模型关注异常样本。
![[截屏2025-10-23 22.38.40.png]]
模型评估时，我们重点看召回率（捕捉异常样本的能力），最终推荐阈值 0.038 对应的召回率达 0.85，ROC-AUC 为 0.684。特征重要性分析显示，cfEB、13 号染色体 GC 含量、BMI 是 Top3 影响因素，这与前几问的结论相互印证，也为临床医生提供了明确的风险指标。![[截屏2025-10-23 22.39.00.png]]

## 六、竞赛落幕：从模型到临床的 “未完之路”

2025 年 2 月，当团队将最终论文提交到「高教社杯」系统时，窗外已经泛起晨光。五个月里，我们推翻过 3 次建模思路，调试 AFT 模型参数到凌晨，为了一个数据异常值争论半天 —— 但当看到最终结果：不同 BMI 组的推荐检测时点能精准匹配临床风险，女胎异常判定模型的漏诊率控制在 15% 以下时，所有的辛苦都有了意义。

这次竞赛让主播和团队深刻明白，数学建模不是 “炫技”，而是要扎根实际需求：混合效应模型的价值在于尊重个体差异，AFT 模型的优势在于贴合检测数据特性，风险控制的核心是为医生提供 “可信赖的决策依据”。未来，我们计划用多中心数据验证模型泛化性，让这份竞赛成果真正走进临床，不再让 “时机不当” 成为医患的遗憾。

或许这份研究不是最完美的，但它承载着一群大学生对 “用数据解决临床痛点” 的初心 —— 而这，正是「高教社杯」教会我们的最重要的事。